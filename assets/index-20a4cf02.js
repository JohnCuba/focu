var fe=Object.defineProperty;var he=(s,e,t)=>e in s?fe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var d=(s,e,t)=>(he(s,typeof e!="symbol"?e+"":e,t),t);import{d as X,r as b,a as D,o as T,c as R,b as f,t as P,n as L,F as Y,e as pe,f as K,p as Z,g as ee,_ as A,w as _e,T as ve,h as me,i as te,s as se,j as E,u as v,k as be,l as ge,m as we,q as x,v as ye,x as ne,y as Se,z as Te,A as j,B as V,C as ke,D as oe,E as Ie,G as Oe,H as F,I as Re,J as xe,K as We}from"./index-28cd214c.js";class Ce{constructor({host:e}){d(this,"_host");d(this,"_headers",{"Content-Type":"application/json"});d(this,"get",async e=>this.makeRequest(e,"GET"));d(this,"post",async(e,{body:t})=>this.makeRequest(e,"POST",{body:t}));this._host=e}get host(){return this._host}prepareBody(e){return e?{body:JSON.stringify(e)}:{}}async makeRequest(e,t,n){const a=new URL(e,this.host),o=await globalThis.fetch(a,{method:t,...this.prepareBody(n==null?void 0:n.body),headers:{...this._headers}});if(o.ok)return await o.json();{const r=await o.text();return Promise.reject(new Error(`[Fetcher][${a.toString()}]: `+r))}}}class De{constructor(e,t){d(this,"fetcher");d(this,"source");d(this,"target");this.source=e,this.target=t,this.fetcher=new Ce({host:"https://translate.argosopentech.com/"})}getTranslation(e){return this.fetcher.post("/translate",{body:{q:e,source:this.source,target:this.target}}).then(t=>t.translatedText)}}const Ee={"en-ru":{key:"en-ru",source:"en",target:"ru"}};class Pe{constructor(e,t){d(this,"_database");d(this,"name");d(this,"version");d(this,"handleOpen",e=>{this._database=e.result});d(this,"handleUpgrade",(e,t)=>{switch(t.oldVersion){default:{this.create(e);break}}});d(this,"create",e=>{this.database||(this._database=e.result),Object.keys(Ee).forEach(t=>{this.database.createObjectStore(t,{keyPath:"id",autoIncrement:!0})})});d(this,"makeGetAllTransaction",async e=>(await this.initDb(),new Promise((t,n)=>{const r=this.database.transaction(e,"readonly").objectStore(e).getAll();r.onsuccess=()=>t(r.result),r.onerror=()=>n(`[LocalDatabase][${e}]: Unable to get all`)})));d(this,"makeAddTransaction",async(e,t)=>(await this.initDb(),new Promise((n,a)=>{const i=this.database.transaction(e,"readwrite").objectStore(e).add(t);i.onsuccess=()=>n({...t,id:i.result}),i.onerror=()=>a(`[LocalDatabase][${e}]: Unable to add ${t}`)})));d(this,"makeDeleteTransaction",async(e,t)=>(await this.initDb(),new Promise((n,a)=>{const i=this.database.transaction(e,"readwrite").objectStore(e).delete(t);i.onsuccess=()=>n(t),i.onerror=()=>a(`[LocalDatabase][${e}]: Unable to delete ${t}`)})));this.name=e,this.version=t}get database(){return this._database}initDb(){return new Promise((e,t)=>{if(this.database)return e("Local database already initialized");const n=globalThis.indexedDB.open(this.name,this.version);n.onsuccess=()=>{this.handleOpen(n),e("Local database opened")},n.onupgradeneeded=a=>{this.handleUpgrade(n,a),e("Local database upgraded")},n.onerror=t})}}class Le{constructor(e){d(this,"dbInstance");d(this,"dbName","dictionaries");d(this,"dbVersion",1);d(this,"dbStoreKey");this.dbStoreKey=e,this.dbInstance=new Pe(this.dbName,this.dbVersion),this.dbInstance.initDb()}getDictionary(){return this.dbInstance.makeGetAllTransaction(this.dbStoreKey)}addWord(e){return this.dbInstance.makeAddTransaction(this.dbStoreKey,e)}deleteWord(e){return this.dbInstance.makeDeleteTransaction(this.dbStoreKey,e)}}class Ae{constructor(e="en-ru"){d(this,"localService");d(this,"translationService");this.localService=new Le(e),this.translationService=new De("en","ru")}getAll(){return this.localService.getDictionary()}async addWord(e){const t=await this.translationService.getTranslation(e.value);return this.localService.addWord({...e,translation:t,dateAdd:Date.now()})}deleteWord(e){return this.localService.deleteWord(e)}}const ae=Symbol("dictionary-store"),re=X("dictionary",()=>{const s=new Ae,e=b([]);return{words:e,setWord:async({value:o})=>{const r={value:o},i=await s.addWord(r);e.value=[i,...e.value]},removeWord:async o=>{const r=await s.deleteWord(o);e.value=e.value.filter(({id:i})=>i!==r)},fetchWords:async()=>{e.value=await s.getAll().then(o=>o.reverse())}}}),$e={class:"cell"},je=D({__name:"table_row",props:{word:null,isSelected:{type:Boolean}},emits:["click"],setup(s,{emit:e}){const t=s,n=()=>{e("click",t.word)};return(a,o)=>(T(),R("tr",{class:L({"is-selected":s.isSelected}),onClick:n},[f("td",null,P(s.word.value),1),f("td",$e,P(s.word.translation),1)],2))}}),Ne=s=>(Z("data-v-e154bbaa"),s=s(),ee(),s),Be={class:"table is-fullwidth is-striped is-hoverable"},Ve=Ne(()=>f("thead",null,[f("tr",{class:"row"},[f("th",{class:"cell"}," Word "),f("th",{class:"cell"}," Translation ")])],-1)),Fe=D({__name:"dictionary_table",props:{words:null,selectedWord:null},emits:["click:word"],setup(s,{emit:e}){const t=n=>{e("click:word",n)};return(n,a)=>(T(),R("table",Be,[Ve,f("tbody",null,[(T(!0),R(Y,null,pe(s.words,o=>{var r;return T(),K(je,{key:o.id,word:o,"is-selected":((r=s.selectedWord)==null?void 0:r.id)===o.id,onClick:t},null,8,["word","is-selected"])}),128))])]))}});const He=A(Fe,[["__scopeId","data-v-e154bbaa"]]),Ue="/focu/img/icons/delete_forever.svg",Me=s=>(Z("data-v-7d7b757e"),s=s(),ee(),s),Qe={key:0,class:"modal is-active"},qe=["onClick"],Ge={class:"modal-content"},ze={class:"box"},Je={class:"level"},Xe={class:"level-left"},Ye={class:"level-item title"},Ke=Me(()=>f("span",{class:"icon"},[f("img",{src:Ue,alt:"delete word",width:"24",height:"24"})],-1)),Ze=[Ke],et={class:"subtitle"},tt=D({__name:"record_modal",props:{word:null},emits:["click:background","click:remove"],setup(s,{emit:e}){const t=s,n=()=>{e("click:background")},a=()=>{t.word&&e("click:remove",t.word)};return(o,r)=>(T(),K(ve,{name:"modal"},{default:_e(()=>[s.word?(T(),R("div",Qe,[f("div",{class:"modal-background",onClick:me(n,["self"])},null,8,qe),f("div",Ge,[f("div",ze,[f("div",Je,[f("div",Xe,[f("h1",Ye,P(s.word.value),1)]),f("div",{class:"level-right"},[f("button",{class:"level-item button is-danger is-light",onClick:a},Ze)])]),f("p",et,P(s.word.translation),1)])])])):te("",!0)]),_:1}))}});const st=A(tt,[["__scopeId","data-v-7d7b757e"]]),nt=D({__name:"index",setup(s){const e=re(),{words:t}=se(e),{removeWord:n}=e,a=b(),o=c=>{a.value=c},r=()=>{a.value=void 0},i=c=>{n(c.id),r()};return(c,p)=>(T(),R(Y,null,[E(He,{words:v(t),"selected-word":a.value,"onClick:word":o},null,8,["words","selected-word"]),E(v(st),{word:a.value,"onClick:background":r,"onClick:remove":i},null,8,["word"])],64))}}),ot=X("editor",()=>{const s=be(ae),e=b(""),t=b(!1);async function n(){t.value=!0;const o=e.value;o&&(await(s==null?void 0:s.setWord({value:o})),a(),t.value=!1)}function a(){e.value=""}return{value:e,isLoading:t,submitWord:n}});var H;const ie=typeof window<"u",at=s=>typeof s=="string",C=()=>{};ie&&((H=window==null?void 0:window.navigator)!=null&&H.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function k(s){return typeof s=="function"?s():v(s)}function le(s,e){function t(...n){return new Promise((a,o)=>{Promise.resolve(s(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(a).catch(o)})}return t}function rt(s,e={}){let t,n,a=C;const o=i=>{clearTimeout(i),a(),a=C};return i=>{const c=k(s),p=k(e.maxWait);return t&&o(t),c<=0||p!==void 0&&p<=0?(n&&(o(n),n=null),Promise.resolve(i())):new Promise((l,_)=>{a=e.rejectOnCancel?_:l,p&&!n&&(n=setTimeout(()=>{t&&o(t),n=null,l(i())},p)),t=setTimeout(()=>{n&&o(n),n=null,l(i())},c)})}}function it(s,e=!0,t=!0,n=!1){let a=0,o,r=!0,i=C,c;const p=()=>{o&&(clearTimeout(o),o=void 0,i(),i=C)};return _=>{const h=k(s),w=Date.now()-a,u=()=>c=_();return p(),h<=0?(a=Date.now(),u()):(w>h&&(t||!r)?(a=Date.now(),u()):e&&(c=new Promise((m,y)=>{i=n?y:m,o=setTimeout(()=>{a=Date.now(),r=!0,m(u()),p()},Math.max(0,h-w))})),!t&&!o&&(o=setTimeout(()=>r=!0,h)),r=!1,c)}}function lt(s){return s}function ce(s){return ge()?(we(s),!0):!1}function ct(s,e=200,t={}){return le(rt(e,t),s)}function ut(s,e=200,t=!1,n=!0,a=!1){return le(it(e,t,n,a),s)}function dt(s){return typeof s=="function"?x(s):b(s)}function ft(s,e=!0){ye()?ne(s):e?s():Se(s)}function ht(s){var e;const t=k(s);return(e=t==null?void 0:t.$el)!=null?e:t}const ue=ie?window:void 0;function U(...s){let e,t,n,a;if(at(s[0])||Array.isArray(s[0])?([t,n,a]=s,e=ue):[e,t,n,a]=s,!e)return C;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const o=[],r=()=>{o.forEach(l=>l()),o.length=0},i=(l,_,h,w)=>(l.addEventListener(_,h,w),()=>l.removeEventListener(_,h,w)),c=j(()=>[ht(e),k(a)],([l,_])=>{r(),l&&o.push(...t.flatMap(h=>n.map(w=>i(l,h,w,_))))},{immediate:!0,flush:"post"}),p=()=>{c(),r()};return ce(p),p}function pt(s,e=!1){const t=b(),n=()=>t.value=!!s();return n(),ft(n,e),t}const M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Q="__vueuse_ssr_handlers__";M[Q]=M[Q]||{};const q=1;function _t(s,e={}){const{throttle:t=0,idle:n=200,onStop:a=C,onScroll:o=C,offset:r={left:0,right:0,top:0,bottom:0},eventListenerOptions:i={capture:!1,passive:!0},behavior:c="auto"}=e,p=b(0),l=b(0),_=x({get(){return p.value},set(g){w(g,void 0)}}),h=x({get(){return l.value},set(g){w(void 0,g)}});function w(g,I){var O,S,B;const $=k(s);$&&((B=$ instanceof Document?document.body:$)==null||B.scrollTo({top:(O=k(I))!=null?O:h.value,left:(S=k(g))!=null?S:_.value,behavior:k(c)}))}const u=b(!1),m=V({left:!0,right:!1,top:!0,bottom:!1}),y=V({left:!1,right:!1,top:!1,bottom:!1}),W=g=>{u.value&&(u.value=!1,y.left=!1,y.right=!1,y.top=!1,y.bottom=!1,a(g))},de=ct(W,t+n),N=g=>{const I=g.target===document?g.target.documentElement:g.target,O=I.scrollLeft;y.left=O<p.value,y.right=O>l.value,m.left=O<=0+(r.left||0),m.right=O+I.clientWidth>=I.scrollWidth-(r.right||0)-q,p.value=O;let S=I.scrollTop;g.target===document&&!S&&(S=document.body.scrollTop),y.top=S<l.value,y.bottom=S>l.value,m.top=S<=0+(r.top||0),m.bottom=S+I.clientHeight>=I.scrollHeight-(r.bottom||0)-q,l.value=S,u.value=!0,de(g),o(g)};return U(s,"scroll",t?ut(N,t,!0,!1):N,i),U(s,"scrollend",W,i),{x:_,y:h,isScrolling:u,arrivedState:m,directions:y}}var G;(function(s){s.UP="UP",s.RIGHT="RIGHT",s.DOWN="DOWN",s.LEFT="LEFT",s.NONE="NONE"})(G||(G={}));function vt(s={}){const{interimResults:e=!0,continuous:t=!0,window:n=ue}=s,a=dt(s.lang||"en-US"),o=b(!1),r=b(!1),i=b(""),c=Te(void 0),p=(m=!o.value)=>{o.value=m},l=()=>{o.value=!0},_=()=>{o.value=!1},h=n&&(n.SpeechRecognition||n.webkitSpeechRecognition),w=pt(()=>h);let u;return w.value&&(u=new h,u.continuous=t,u.interimResults=e,u.lang=v(a),u.onstart=()=>{r.value=!1},j(a,m=>{u&&!o.value&&(u.lang=m)}),u.onresult=m=>{const y=Array.from(m.results).map(W=>(r.value=W.isFinal,W[0])).map(W=>W.transcript).join("");i.value=y,c.value=void 0},u.onerror=m=>{c.value=m},u.onend=()=>{o.value=!1,u.lang=v(a)},j(o,()=>{o.value?u.start():u.stop()})),ce(()=>{o.value=!1}),{isSupported:w,isListening:o,isFinal:r,recognition:u,result:i,error:c,toggle:p,start:l,stop:_}}var mt=Object.defineProperty,z=Object.getOwnPropertySymbols,bt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,J=(s,e,t)=>e in s?mt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,wt=(s,e)=>{for(var t in e||(e={}))bt.call(e,t)&&J(s,t,e[t]);if(z)for(var t of z(e))gt.call(e,t)&&J(s,t,e[t]);return s};const yt={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};wt({linear:lt},yt);const St=({element:s=document,offset:e}=Tt)=>{const{directions:t,y:n}=_t(s,{behavior:"smooth"}),{top:a,bottom:o}=ke(t),r=b(!1);return oe(()=>{a.value?r.value=!1:n.value>((e==null?void 0:e.value)??0)&&o.value&&(r.value=!0)},{flush:"post"}),{isHidden:r}},Tt={element:document},kt={class:"icon is-medium"},It=["src"],Ot=D({__name:"speech",emits:["update:modelValue"],setup(s,{emit:e}){const{isSupported:t,isListening:n,isFinal:a,result:o,start:r,stop:i}=vt(),c=x(()=>`/img/icons/${n.value?"voice_recording":"mic"}.svg`),p=x(()=>({"is-primary":!n.value,"is-warning":n.value})),l=()=>{n.value?i():r()};return oe(()=>{a.value&&(e("update:modelValue",o.value),i())}),(_,h)=>v(t)?(T(),R("button",{key:0,class:L(["button is-large is-rounded is-primary is-light",v(p)]),onClick:l},[f("span",kt,[f("img",{src:v(c),alt:"toggle speech recognize",width:"48",height:"48"},null,8,It)])],2)):te("",!0)}}),Rt=["disabled"],xt=D({__name:"editor",setup(s,{expose:e}){const t=b(),n=ot(),{value:a,isLoading:o}=se(n),{submitWord:r}=n,i=x(()=>{var l;return((l=t.value)==null?void 0:l.offsetHeight)||0}),c=x(()=>({"is-loading":o.value})),{isHidden:p}=St({offset:i});return e({elementRef:t}),(l,_)=>(T(),R("div",{ref_key:"elementRef",ref:t,class:L(["root",{"root--hidden":v(p)}])},[f("div",{class:L(["input-wrapper control is-large",v(c)])},[Ie(f("input",{"onUpdate:modelValue":_[0]||(_[0]=h=>F(a)?a.value=h:null),type:"text",class:"input is-large is-rounded is-primary",placeholder:"Type something...",disabled:v(o),onKeypress:_[1]||(_[1]=Re((...h)=>v(r)&&v(r)(...h),["enter"]))},null,40,Rt),[[Oe,v(a)]])],2),E(Ot,{modelValue:v(a),"onUpdate:modelValue":_[2]||(_[2]=h=>F(a)?a.value=h:null)},null,8,["modelValue"])],2))}});const Wt=A(xt,[["__scopeId","data-v-b8a8e209"]]),Ct={class:"main"},Dt=D({__name:"index",setup(s){const e=re();We(ae,e);const t=b(),n=x(()=>{var a;return{"margin-top":`calc(${(a=t.value)==null?void 0:a.elementRef.offsetHeight}px + var(--spacing))`}});return ne(()=>{e.fetchWords()}),(a,o)=>(T(),R("main",Ct,[E(v(Wt),{ref_key:"editorRef",ref:t},null,512),f("section",{style:xe(v(n))},[E(v(nt))],4)]))}});const Lt=A(Dt,[["__scopeId","data-v-9b240e33"]]);export{Lt as default};
